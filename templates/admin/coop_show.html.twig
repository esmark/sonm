{% extends 'base.html.twig' %}

{% block title %}Кооперативы - Админка{% endblock %}

{% block content %}

    <h1>Кооператив</h1>

    <table class="table table-bordered table-hover">
        <tr>
            <th style="width: 170px;">Название</th>
            <td>{{ coop }}</td>
        </tr>
        <tr>
            <th>Статус</th>
            <td>
                {{ coop.statusAsText }}
                {% if coop.status == 0 %}
                    <a href="?approve" class="btn btn-success" onclick="return confirm('Вы уверены, что хотите заверить заявку?')">Заверить</a>
                    <a href="?decline" class="btn btn-danger" onclick="return confirm('Вы уверены, что хотите отклонить заявку?')">Отклонить</a>
                {% endif %}
            </td>
        </tr>
        <tr>
            <th>Техническое имя</th>
            <td>{{ coop.name }}</td>
        </tr>
        <tr>
            <th>ОГРН</th>
            <td>{{ coop.ogrn }}</td>
        </tr>
        <tr>
            <th>ИНН</th>
            <td>{{ coop.inn }}</td>
        </tr>
        <tr>
            <th>КПП</th>
            <td>{{ coop.kpp }}</td>
        </tr>
        <tr>
            <th>Директор</th>
            <td>{{ coop.director }}</td>
        </tr>
        <tr>
            <th>Описание</th>
            <td>{{ coop.description }}</td>
        </tr>
        <tr>
            <th>Адрес</th>
            <td>{{ coop.address }}</td>
        </tr>
        <tr>
            <th>Дата создания</th>
            <td>{{ coop.createdAt|date }}</td>
        </tr>
    </table>

    <h3>Участники ({{ coop.members|length }})</h3>

    <table class="table table-bordered table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Имя</th>
            <th>Статус</th>
            <th>Дата регистрации</th>
        </tr>
        </thead>
        <tbody>
        {% for member in coop.members %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ member.user }}</td>
                <td>{{ member.statusAsText }}</td>
                <td>{{ member.createdAt|date }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <h3>История изменений ({{ coop.history|length }})</h3>

    <table class="table table-bordered table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Действие</th>
            <th>Пользователь</th>
            <th>Старые значения</th>
            <th>Новые значения</th>
            <th>Дата регистрации</th>
        </tr>
        </thead>
        <tbody>
        {% for history in coop.history %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ history.actionAsText }}</td>
                <td>{{ history.user }}</td>
                <td>
                    <ul>
                        {% for key, val in history.oldValue %}
                            <li><b>{{ key }}</b>: {{ val|e }}</li>
                        {% endfor %}
                    </ul>
                </td>
                <td>
                    <ul>
                        {% for key, val in history.newValue %}
                            <li><b>{{ key }}</b>: {{ val|e }}</li>
                        {% endfor %}
                    </ul>
                </td>
                <td>{{ history.createdAt|date }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>


{% endblock %}
